/* ================================
   BE FREE TOURS - CSS ELITE 2026+
   Cascade Layers • OKLCH • Nesting • Container Queries
   ================================ */

/* --------------------------------
   Declare Layer Order (Specificity Control)
   -------------------------------- */
@layer reset, base, themes, components, utilities, overrides;

/* ================================
   LAYER: RESET
   ================================ */
@layer reset {
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  /* Reset only elements that typically have margin/padding */
  h1, h2, h3, h4, h5, h6,
  p, ul, ol, figure,
  blockquote, dl, dd {
    margin: 0;
  }

  ul, ol {
    padding: 0;
    list-style: none;
  }

  html {
    -moz-text-size-adjust: none;
    -webkit-text-size-adjust: none;
    text-size-adjust: none;
    scroll-behavior: smooth;
  }

  body {
    min-height: 100vh;
    line-height: var(--line-height-normal);
    font-family: var(--font-family);
    font-weight: 400;
    color: var(--color-text);
    background-color: var(--color-bg-white);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  img,
  picture,
  video,
  canvas,
  svg {
    display: block;
    max-width: 100%;
    height: auto;
  }

  input,
  button,
  textarea,
  select {
    font: inherit;
  }

  button {
    cursor: pointer;
    border: none;
    background: none;
  }

  a {
    color: inherit;
    text-decoration: none;
  }

  h1, h2, h3, h4, h5, h6 {
    line-height: 1.2;
    font-weight: 700;
    text-wrap: balance;
  }

  p {
    text-wrap: pretty;
  }

  /* Global hero title styling */
  .hero-title {
    letter-spacing: var(--tracking-tight);
  }

  /* Accessibility - Reduced Motion */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

/* ================================
   LAYER: BASE (Design Tokens)
   ================================ */
@layer base {

  /* --------------------------------
     Color System - OKLCH (2026+)
     Perceptually uniform colors
     -------------------------------- */
  @supports (color: oklch(0% 0 0)) {
    :root {
      /* Primary - Deep Blue Night */
      --color-primary-base: oklch(15% 0.08 255);
      --color-primary: var(--color-primary-base);
      --color-primary-light: oklch(from var(--color-primary-base) calc(l + 10%) c h);
      --color-primary-dark: oklch(from var(--color-primary-base) calc(l - 5%) c h);

      /* Accent - Sunset Orange/Gold */
      --color-accent-base: oklch(65% 0.18 45);
      --color-accent: var(--color-accent-base);
      --color-accent-light: oklch(from var(--color-accent-base) calc(l + 10%) c h);
      --color-accent-dark: oklch(from var(--color-accent-base) calc(l - 10%) c h);

      /* Secondary - Cyan/Teal */
      --color-secondary-base: oklch(60% 0.15 205);
      --color-secondary: var(--color-secondary-base);
      --color-secondary-light: oklch(from var(--color-secondary-base) calc(l + 10%) c h);
      --color-secondary-dark: oklch(from var(--color-secondary-base) calc(l - 10%) c h);

      /* Backgrounds - Dark with depth */
      --color-bg-base: oklch(15% 0.08 255);
      --color-bg-white: var(--color-bg-base);
      --color-bg-soft: oklch(18% 0.08 255);
      --color-bg-dark: oklch(10% 0.08 255);
      --color-bg-card: color-mix(in oklch, var(--color-bg-soft) 80%, transparent);

      /* Text - Light for contrast */
      --color-text: oklch(98% 0.01 255);
      --color-text-light: oklch(70% 0.02 255);
      --color-text-muted: oklch(55% 0.02 255);
      --color-text-inverse: oklch(98% 0.01 255);

      /* Utilities */
      --color-border: color-mix(in oklch, var(--color-text-light) 20%, transparent);
      --color-border-light: color-mix(in oklch, var(--color-text-light) 10%, transparent);
      --color-success: oklch(65% 0.18 145);
      --color-error: oklch(60% 0.20 25);

      /* Glassmorphism */
      --glass-bg: color-mix(in oklch, var(--color-bg-soft) 70%, transparent);
      --glass-border: color-mix(in oklch, white 10%, transparent);
      --glass-shadow: 0 8px 32px oklch(0% 0 0 / 0.3);

      /* Gradients with smooth transitions */
      --gradient-hero: linear-gradient(
        135deg in oklch,
        oklch(15% 0.08 255 / 0.9) 0%,
        oklch(15% 0.08 255 / 0.4) 50%,
        oklch(15% 0.08 255 / 0.7) 100%
      );
      --gradient-card: linear-gradient(
        180deg in oklch,
        oklch(18% 0.08 255 / 0) 0%,
        oklch(15% 0.08 255 / 0.95) 100%
      );
      --gradient-accent: linear-gradient(
        135deg in oklch,
        oklch(65% 0.18 45) 0%,
        oklch(70% 0.18 45) 100%
      );
    }
  }

  /* Fallback for browsers without OKLCH support */
  @supports not (color: oklch(0% 0 0)) {
    :root {
      /* Primary */
      --color-primary: #0a1628;
      --color-primary-light: #1a2d4a;
      --color-primary-dark: #050d18;

      /* Accent */
      --color-accent: #f97316;
      --color-accent-light: #fb923c;
      --color-accent-dark: #ea580c;

      /* Secondary */
      --color-secondary: #06b6d4;
      --color-secondary-light: #22d3ee;
      --color-secondary-dark: #0891b2;

      /* Backgrounds */
      --color-bg-white: #0a1628;
      --color-bg-soft: #0f1e32;
      --color-bg-dark: #050d18;
      --color-bg-card: rgba(15, 30, 50, 0.8);

      /* Text */
      --color-text: #f8fafc;
      --color-text-light: #94a3b8;
      --color-text-muted: #64748b;
      --color-text-inverse: #f8fafc;

      /* Utilities */
      --color-border: rgba(148, 163, 184, 0.2);
      --color-border-light: rgba(148, 163, 184, 0.1);
      --color-success: #22c55e;
      --color-error: #ef4444;

      /* Glass */
      --glass-bg: rgba(15, 30, 50, 0.7);
      --glass-border: rgba(255, 255, 255, 0.1);
      --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);

      /* Gradients */
      --gradient-hero: linear-gradient(135deg, rgba(10, 22, 40, 0.9) 0%, rgba(10, 22, 40, 0.4) 50%, rgba(10, 22, 40, 0.7) 100%);
      --gradient-card: linear-gradient(180deg, rgba(15, 30, 50, 0) 0%, rgba(10, 22, 40, 0.95) 100%);
      --gradient-accent: linear-gradient(135deg, #f97316 0%, #fb923c 100%);
    }
  }

  /* --------------------------------
     Typography System
     -------------------------------- */
  :root {
    /* Font family */
    --font-family: 'Plus Jakarta Sans', system-ui, -apple-system, sans-serif;

    /* Letter spacing */
    --tracking-tight: -0.015em;
    --tracking-wide: 0.05em;

    /* Fluid font sizes */
    --font-size-h1: clamp(2.25rem, 5vw + 1rem, 3.75rem);
    --font-size-h2: clamp(1.875rem, 4vw + 0.75rem, 3rem);
    --font-size-h3: clamp(1.5rem, 3vw + 0.5rem, 2.25rem);
    --font-size-h4: clamp(1.25rem, 2vw + 0.5rem, 1.75rem);
    --font-size-h5: clamp(1.125rem, 1.5vw + 0.5rem, 1.5rem);
    --font-size-h6: clamp(1rem, 1vw + 0.5rem, 1.25rem);
    --font-size-body: clamp(0.9375rem, 0.5vw + 0.875rem, 1.125rem);
    --font-size-small: clamp(0.8125rem, 0.5vw + 0.75rem, 1rem);
    --font-size-xs: clamp(0.6875rem, 0.25vw + 0.625rem, 0.875rem);

    /* Font weights */
    --font-weight-regular: 400;
    --font-weight-medium: 500;
    --font-weight-semibold: 600;
    --font-weight-bold: 700;

    /* Line heights */
    --line-height-tight: 1.2;
    --line-height-normal: 1.6;
    --line-height-relaxed: 1.8;
  }

  /* --------------------------------
     Spacing System
     -------------------------------- */
  :root {
    --space-2xs: clamp(0.25rem, 0.4vw, 0.375rem);
    --space-xs: clamp(0.25rem, 0.5vw, 0.5rem);
    --space-sm: clamp(0.5rem, 1vw, 0.75rem);
    --space-sm-compact: clamp(0.625rem, 1.2vw, 0.75rem);
    --space-md: clamp(1rem, 2vw, 1.5rem);
    --space-md-compact: clamp(0.75rem, 1.5vw, 0.875rem);
    --space-lg: clamp(1.5rem, 3vw, 2.5rem);
    --space-lg-compact: clamp(1.5rem, 2.5vw, 1.75rem);
    --space-xl: clamp(2rem, 5vw, 4rem);
    --space-xl-compact: clamp(2rem, 4vw, 2.25rem);
    --space-2xl: clamp(3rem, 8vw, 6rem);
    --space-3xl: clamp(4rem, 10vw, 8rem);

    /* Container */
    --container-max: 1200px;
    --container-padding: clamp(1rem, 4vw, 2rem);

    /* Border radius */
    --radius-sm: 0.25rem;
    --radius-md: 0.5rem;
    --radius-lg: 1rem;
    --radius-full: 9999px;
  }

  /* --------------------------------
     Effects & Sizes
     -------------------------------- */
  :root {
    --border-width-hairline: 1px;
    --border-width-regular: 2px;
    --border-width-strong: 3px;

    --blur-sm: clamp(8px, 1vw, 10px);
    --blur-md: clamp(12px, 1.5vw, 14px);

    --focus-outline-width: var(--border-width-strong);
    --focus-outline-offset: 2px;

    --motion-lift-sm: -2px;
    --motion-press-scale: 0.98;

    --decorator-width: clamp(30px, 6vw, 60px);
    --decorator-width-compact: clamp(20px, 5vw, 30px);
    --decorator-height: 1px;

    --shadow-accent-sm: 0 4px 14px color-mix(in oklch, var(--color-accent) 40%, transparent);
    --shadow-accent-md: 0 6px 20px color-mix(in oklch, var(--color-accent) 50%, transparent);
    --shadow-soft: 0 8px 32px color-mix(in oklch, var(--color-text) 10%, transparent);

    --intrinsic-card: clamp(320px, 40vw, 400px);
    --intrinsic-step: clamp(240px, 30vw, 300px);
    --intrinsic-testimonial: clamp(280px, 35vw, 350px);
    --intrinsic-tour: clamp(360px, 45vw, 450px);
    --intrinsic-faq: clamp(180px, 25vw, 200px);

    --grid-min-sm: 200px;
    --grid-min-md: 300px;
    --grid-min-lg: 400px;
    --grid-min-2: 450px;
    --grid-min-3: 300px;
    --grid-min-4: 250px;

    --hero-min-height-mobile: 100svh;
  }

  /* --------------------------------
     Animation/Transition Tokens
     -------------------------------- */
  :root {
    --transition-duration-fast: 150ms;
    --transition-duration-normal: 200ms;
    --transition-duration-slow: 300ms;
    --transition-easing-default: ease;
    --transition-easing-smooth: cubic-bezier(0.4, 0, 0.2, 1);
    --transition-easing-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }

  /* --------------------------------
     Typography Application
     -------------------------------- */
  h1 {
    font-size: var(--font-size-h1);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
  }

  h2 {
    font-size: var(--font-size-h2);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
  }

  h3 {
    font-size: var(--font-size-h3);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-tight);
  }

  h4 {
    font-size: var(--font-size-h4);
    font-weight: var(--font-weight-semibold);
    line-height: var(--line-height-tight);
  }

  h5 {
    font-size: var(--font-size-h5);
    font-weight: var(--font-weight-semibold);
    line-height: var(--line-height-tight);
  }

  h6 {
    font-size: var(--font-size-h6);
    font-weight: var(--font-weight-semibold);
    line-height: var(--line-height-tight);
  }

  p {
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-regular);
    line-height: var(--line-height-normal);
  }

  small {
    font-size: var(--font-size-small);
    font-weight: var(--font-weight-regular);
    line-height: var(--line-height-normal);
  }

  a {
    font-size: var(--font-size-body);
    font-weight: var(--font-weight-medium);
    color: var(--color-secondary-light);
    transition: color var(--transition-duration-normal) var(--transition-easing-default);

    &:hover {
      color: var(--color-accent);
    }
  }
}

/* ================================
   LAYER: THEMES
   ================================ */
@layer themes {

  /* --------------------------------
     Light Theme (OKLCH with fallback)
     -------------------------------- */
  @supports (color: oklch(0% 0 0)) {
    html.light,
    :root.light {
      /* Primary */
      --color-primary-base: oklch(18% 0.08 255);
      --color-primary: var(--color-primary-base);
      --color-primary-light: oklch(from var(--color-primary-base) calc(l + 5%) c h);
      --color-primary-dark: oklch(from var(--color-primary-base) calc(l - 8%) c h);

      /* Backgrounds - Coastal Light */
      --color-bg-white: oklch(99% 0.01 255);
      --color-bg-soft: oklch(96% 0.01 255);
      --color-bg-dark: oklch(18% 0.08 255);
      --color-bg-card: oklch(100% 0 0);
      --color-bg-alt: oklch(94% 0.02 255);

      /* Text */
      --color-text: oklch(18% 0.08 255);
      --color-text-light: oklch(45% 0.04 255);
      --color-text-muted: oklch(55% 0.02 255);
      --color-text-inverse: oklch(98% 0.01 255);

      /* Utilities */
      --color-border: color-mix(in oklch, var(--color-text) 8%, transparent);
      --color-border-light: color-mix(in oklch, var(--color-text) 4%, transparent);

      /* Glass */
      --glass-bg: color-mix(in oklch, white 80%, transparent);
      --glass-border: color-mix(in oklch, var(--color-text) 6%, transparent);
      --glass-shadow: 0 4px 24px oklch(18% 0.08 255 / 0.08);

      /* Gradients */
      --gradient-hero: linear-gradient(
        135deg in oklch,
        oklch(18% 0.08 255 / 0.85) 0%,
        oklch(18% 0.08 255 / 0.4) 50%,
        oklch(18% 0.08 255 / 0.7) 100%
      );
      --gradient-card: linear-gradient(
        180deg in oklch,
        oklch(18% 0.08 255 / 0) 0%,
        oklch(18% 0.08 255 / 0.85) 100%
      );
    }
  }

  @supports not (color: oklch(0% 0 0)) {
    html.light,
    :root.light {
      --color-primary: #0f172a;
      --color-primary-light: #1e293b;
      --color-primary-dark: #020617;

      --color-bg-white: #fafbfd;
      --color-bg-soft: #f1f5f9;
      --color-bg-dark: #0f172a;
      --color-bg-card: #ffffff;
      --color-bg-alt: #e8eef6;

      --color-text: #0f172a;
      --color-text-light: #475569;
      --color-text-muted: #64748b;
      --color-text-inverse: #f8fafc;

      --color-border: rgba(15, 23, 42, 0.08);
      --color-border-light: rgba(15, 23, 42, 0.04);

      --glass-bg: rgba(255, 255, 255, 0.8);
      --glass-border: rgba(15, 23, 42, 0.06);
      --glass-shadow: 0 4px 24px rgba(15, 23, 42, 0.08);

      --gradient-hero: linear-gradient(135deg, rgba(15, 23, 42, 0.85) 0%, rgba(15, 23, 42, 0.4) 50%, rgba(15, 23, 42, 0.7) 100%);
      --gradient-card: linear-gradient(180deg, rgba(15, 23, 42, 0) 0%, rgba(15, 23, 42, 0.85) 100%);
    }
  }

  /* --------------------------------
     Light Theme Component Overrides (Nested)
     -------------------------------- */
  html.light {
    /* Navbar - Dark anchor */
    .navbar {
      background: color-mix(in srgb, var(--color-primary) 95%, transparent);
      backdrop-filter: blur(var(--blur-md));
      -webkit-backdrop-filter: blur(var(--blur-md));
      border-block-end: var(--border-width-hairline) solid color-mix(in srgb, white 10%, transparent);

      &.scrolled {
        background: color-mix(in srgb, var(--color-primary) 98%, transparent);
      }
    }

    .nav-link {
      color: color-mix(in srgb, white 80%, transparent);

      &:hover,
      &.active {
        color: white;
        background-color: color-mix(in srgb, white 10%, transparent);
      }
    }

    .icon-button {
      color: color-mix(in srgb, white 80%, transparent);

      &:hover {
        background-color: color-mix(in srgb, white 10%, transparent);
        color: white;
      }
    }

    .lang-current {
      color: color-mix(in srgb, white 90%, transparent);
    }

    .lang-dropdown {
      background: oklch(22% 0.08 255);
      border-color: color-mix(in srgb, white 10%, transparent);
      box-shadow: var(--glass-shadow);
    }

    .lang-option {
      color: color-mix(in srgb, white 90%, transparent);

      &:hover {
        background-color: color-mix(in srgb, white 10%, transparent);
      }

      &.active {
        background: var(--gradient-accent);
        color: white;
      }
    }

    .mobile-menu {
      background: oklch(22% 0.08 255);
      border-block-start-color: color-mix(in srgb, white 10%, transparent);
    }

    .mobile-nav-link {
      color: color-mix(in srgb, white 90%, transparent);

      &:hover,
      &.active {
        background-color: color-mix(in srgb, white 10%, transparent);
      }
    }

    .mobile-menu-button {
      color: color-mix(in srgb, white 90%, transparent);
    }

    /* Hero - Light overlay */
    .hero {
      .hero-content,
      .hero-tagline,
      .hero-title,
      .hero-subtitle {
        color: white;
      }

      .hero-tagline {
        color: color-mix(in srgb, white 90%, transparent);
      }

      .hero-subtitle {
        color: color-mix(in srgb, white 95%, transparent);
      }

    .trust-badges {
      background: color-mix(in srgb, var(--color-primary) 85%, transparent);
      backdrop-filter: blur(var(--blur-md));
      -webkit-backdrop-filter: blur(var(--blur-md));
      border-color: color-mix(in srgb, white 15%, transparent);

        .badge-label {
          color: white;
        }

        .badge-value {
          color: color-mix(in srgb, white 70%, transparent);
        }
      }

      .trust-badge {
        border-block-end-color: color-mix(in srgb, white 10%, transparent);
      }
    }

    /* Sections */
    .how-it-works {
      background: linear-gradient(180deg, var(--color-bg-white) 0%, var(--color-bg-soft) 100%);
    }

    .featured-tours {
      background: linear-gradient(180deg, var(--color-bg-soft) 0%, var(--color-bg-alt) 50%, var(--color-bg-soft) 100%);
    }

    .why-us {
      background: linear-gradient(180deg, var(--color-bg-white) 0%, var(--color-bg-soft) 100%);
    }

    .testimonials {
      background: linear-gradient(180deg, var(--color-bg-soft) 0%, var(--color-bg-alt) 50%, var(--color-bg-soft) 100%);
    }

    .faq {
      background: linear-gradient(180deg, var(--color-bg-white) 0%, var(--color-bg-soft) 100%);
    }

    /* CTA - Dark for impact */
    .cta-final {
      background: linear-gradient(135deg, var(--color-primary) 0%, oklch(22% 0.08 255) 50%, var(--color-primary) 100%);

      &::before {
        background-image:
          radial-gradient(circle at 20% 50%, color-mix(in oklch, var(--color-accent) 15%, transparent) 0%, transparent 50%),
          radial-gradient(circle at 80% 80%, color-mix(in oklch, var(--color-secondary) 10%, transparent) 0%, transparent 50%);
      }

      .cta-title,
      .cta-subtitle,
      .trust-text {
        color: white;
      }

      .cta-subtitle {
        color: color-mix(in srgb, white 85%, transparent);
      }

      .trust-badges {
        border-block-start-color: color-mix(in srgb, white 15%, transparent);
      }

      .trust-icon {
        color: var(--color-accent);
      }

      .trust-text {
        color: color-mix(in srgb, white 85%, transparent);
      }

      .btn-outline-secondary {
        border-color: color-mix(in srgb, white 80%, transparent);
        color: white;

        &:hover {
          background-color: color-mix(in srgb, white 15%, transparent);
          border-color: white;
        }
      }
    }

    /* Footer - Dark anchor */
    .footer {
      background-color: var(--color-primary);
      color: var(--color-text-inverse);

      .footer-logo .logo-subtext,
      .footer-title {
        color: var(--color-text-inverse);
      }

      .footer-tagline,
      .footer-links a,
      .footer-contact-item {
        color: color-mix(in srgb, white 70%, transparent);
      }

      .footer-links a:hover {
        color: var(--color-accent);
      }

      .footer-bottom {
        border-block-start-color: color-mix(in srgb, white 10%, transparent);
        color: color-mix(in srgb, white 60%, transparent);

        a {
          color: color-mix(in srgb, white 80%, transparent);

          &:hover {
            color: var(--color-accent);
          }
        }
      }

      .tripadvisor-link {
        background: color-mix(in srgb, white 10%, transparent);
        border-color: color-mix(in srgb, white 15%, transparent);

        &:hover {
          background: color-mix(in srgb, white 15%, transparent);
        }

        span {
          color: color-mix(in srgb, white 90%, transparent);
        }
      }
    }

    /* Cards */
    .step-card,
    .tour-card,
    .testimonial-card,
    .reason-card,
    .faq-item,
    .value-card,
    .stat-card,
    .post-card,
    .contact-info-card {
      background: var(--color-bg-card);
      border: var(--border-width-hairline) solid var(--color-border);
      box-shadow: var(--glass-shadow);

      &:hover {
        box-shadow: var(--shadow-soft);
      }
    }

    /* Text colors */
    .step-title,
    .tour-card-title,
    .testimonial-title,
    .reason-title,
    .faq-question-text,
    .value-title,
    .section-title,
    .story-text h2,
    .post-title {
      color: var(--color-text);
    }

    .step-description,
    .tour-card-meta .tour-duration,
    .tour-card-meta .tour-audience,
    .testimonial-text,
    .reason-description,
    .faq-answer-content,
    .value-description,
    .story-text p,
    .post-excerpt {
      color: var(--color-text-light);
    }

    .step-number,
    .testimonial-source,
    .testimonial-author span,
    .faq-icon,
    .price-label,
    .post-meta time,
    .post-read-time {
      color: var(--color-text-muted);
    }

    .step-icon,
    .reason-icon,
    .testimonial-author strong,
    .price-value {
      color: var(--color-accent);
    }

    /* Borders */
    .testimonial-header,
    .testimonial-footer,
    .tour-card-footer {
      border-color: var(--color-border);
    }

    /* Forms */
    .form-label {
      color: var(--color-text);
    }

    .form-input,
    .form-textarea,
    .form-select {
      background: var(--color-bg-soft);
      border-color: var(--color-border);
      color: var(--color-text);

      &:focus {
        border-color: var(--color-accent);
        background: var(--color-bg-card);
      }

      &::placeholder {
        color: var(--color-text-muted);
      }
    }

    /* Blog */
    .blog-categories {
      background-color: var(--color-bg-soft);
      border-block-end-color: var(--color-border);
    }

    .category-btn,
    .filter-btn {
      background: var(--color-bg-card);
      border-color: var(--color-border);
      color: var(--color-text-light);

      &:hover {
        border-color: var(--color-accent);
      }

      &.active {
        background: var(--gradient-accent);
        color: white;
      }
    }

    /* Internal pages */
    .tours-grid-section,
    .blog-posts,
    .our-story,
    .our-values,
    .contact-content {
      background-color: var(--color-bg-white);
    }

    .tours-hero,
    .about-hero,
    .contact-hero,
    .blog-hero,
    .newsletter-cta,
    .tours-cta {
      background: linear-gradient(135deg, var(--color-primary) 0%, oklch(22% 0.08 255) 100%);

      .hero-title,
      .hero-subtitle,
      .cta-title,
      .cta-subtitle {
        color: white;
      }
    }

    /* Outline buttons on dark backgrounds */
    .hero .btn-outline-secondary,
    .tour-cta .btn-outline-secondary,
    .about-cta .btn-outline-secondary,
    .cta-final .btn-outline-secondary,
    .tours-cta .btn-outline-secondary {
      border-color: color-mix(in srgb, white 80%, transparent);
      color: white;

      &:hover {
        background-color: color-mix(in srgb, white 15%, transparent);
        border-color: white;
      }
    }
  }
}

/* ================================
   LAYER: COMPONENTS
   ================================ */
@media (max-width: 768px) {
  .tours-hero,
  .about-hero,
  .contact-hero,
  .blog-hero,
  .gallery-hero {
    min-height: var(--hero-min-height-mobile);
  }
}
@layer components {

  /* --------------------------------
     Container (with Logical Properties)
     -------------------------------- */
  .container {
    inline-size: 100%;
    max-inline-size: var(--container-max);
    margin-inline: auto;
    padding-inline: max(var(--container-padding), env(safe-area-inset-inline-start));
    container-type: inline-size;
    container-name: main-container;
  }

  /* --------------------------------
     Grid System (Container Query Ready)
     -------------------------------- */
  .grid {
    display: grid;
    gap: var(--space-lg);
    container-type: inline-size;
    container-name: grid;
  }

  /* Grid responsivo - cards pequenos */
  .grid-sm {
    grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--grid-min-sm)), 1fr));
  }

  /* Grid responsivo - cards médios */
  .grid-md {
    grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--grid-min-md)), 1fr));
  }

  /* Grid responsivo - cards grandes */
  .grid-lg {
    grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--grid-min-lg)), 1fr));
  }

  /* Grid fixo - 2 colunas */
  .grid-2 {
    grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--grid-min-2)), 1fr));
  }

  /* Grid fixo - 3 colunas */
  .grid-3 {
    grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--grid-min-3)), 1fr));
  }

  /* Grid fixo - 4 colunas */
  .grid-4 {
    grid-template-columns: repeat(auto-fit, minmax(min(100%, var(--grid-min-4)), 1fr));
  }

  /* Variantes de gap */
  .grid-gap-sm { gap: var(--space-sm); }
  .grid-gap-md { gap: var(--space-md); }
  .grid-gap-lg { gap: var(--space-lg); }
  .grid-gap-xl { gap: var(--space-xl); }

  /* --------------------------------
     Glassmorphism Components
     -------------------------------- */
  .glass {
    background: var(--glass-bg);
    backdrop-filter: blur(var(--blur-md));
    -webkit-backdrop-filter: blur(var(--blur-md));
    border: var(--border-width-hairline) solid var(--glass-border);
    box-shadow: var(--glass-shadow);

    &:hover,
    &:focus-within {
      will-change: backdrop-filter;
    }
  }

  .glass-light {
    background: color-mix(in srgb, white 10%, transparent);
    backdrop-filter: blur(var(--blur-sm));
    -webkit-backdrop-filter: blur(var(--blur-sm));
    border: var(--border-width-hairline) solid color-mix(in srgb, white 15%, transparent);
  }

  /* --------------------------------
     Section Title (Container Query)
     -------------------------------- */
  .section-title-decorated {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-lg);
    font-size: var(--font-size-h2);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);

    &::before,
    &::after {
      content: '';
      block-size: var(--decorator-height);
      inline-size: var(--decorator-width);
      background: linear-gradient(90deg, transparent, var(--color-border), transparent);
    }

    @container (max-width: 768px) {
      font-size: var(--font-size-h4);
      gap: var(--space-md);

      &::before,
      &::after {
        inline-size: var(--decorator-width-compact);
      }
    }
  }

  /* --------------------------------
     Badges
     -------------------------------- */
  .badge {
    --badge-padding-block: var(--space-2xs);
    --badge-padding-inline: var(--space-md-compact);
    --badge-letter-spacing: var(--tracking-wide);

    display: inline-flex;
    align-items: center;
    padding-block: var(--badge-padding-block);
    padding-inline: var(--badge-padding-inline);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-semibold);
    text-transform: uppercase;
    letter-spacing: var(--badge-letter-spacing);
    border-radius: var(--radius-full);

    &.badge-primary {
      background: var(--gradient-accent);
      color: white;
    }

    &.badge-secondary {
      background: var(--color-secondary);
      color: white;
    }

    &.badge-outline {
      background: transparent;
      border: var(--border-width-hairline) solid var(--color-accent);
      color: var(--color-accent);
    }
  }

  /* --------------------------------
     Button System (Nested + Performance)
     -------------------------------- */
  .btn {
    /* Component variables */
    --btn-padding-block: var(--space-md-compact);
    --btn-padding-inline: var(--space-lg-compact);
    --btn-font-size: var(--font-size-body);
    --btn-border-width: var(--border-width-regular);
    --btn-border-radius: var(--radius-md);
    --btn-transition-duration: var(--transition-duration-normal);
    --btn-transition-easing: var(--transition-easing-smooth);
    --btn-gap: var(--space-xs);
    --btn-line-height: 1;

    /* Base styles */
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--btn-gap);
    padding-block: var(--btn-padding-block);
    padding-inline: var(--btn-padding-inline);
    font-family: var(--font-family);
    font-size: var(--btn-font-size);
    font-weight: var(--font-weight-semibold);
    line-height: var(--btn-line-height);
    text-align: center;
    border: var(--btn-border-width) solid transparent;
    border-radius: var(--btn-border-radius);
    cursor: pointer;
    transform: translateZ(0); /* GPU acceleration */
    transition:
      background-color var(--btn-transition-duration) var(--btn-transition-easing),
      color var(--btn-transition-duration) var(--btn-transition-easing),
      border-color var(--btn-transition-duration) var(--btn-transition-easing),
      transform var(--btn-transition-duration) var(--btn-transition-easing),
      box-shadow var(--btn-transition-duration) var(--btn-transition-easing);

    /* Performance hints */
    contain: layout style;

    /* Hover intent (only devices with hover) */
    @media (hover: hover) {
      &:hover {
        transform: translateY(var(--motion-lift-sm));
      }

      &:active {
        transform: translateY(0);
      }
    }

    /* Touch devices */
    @media (hover: none) {
      &:active {
        transform: scale(var(--motion-press-scale));
      }
    }

    &:focus-visible {
      outline: var(--focus-outline-width) solid var(--color-accent-light);
      outline-offset: var(--focus-outline-offset);
    }

    /* Variants */
    &.btn-primary {
      background: var(--gradient-accent);
      border-color: var(--color-accent);
      color: white;
      box-shadow: var(--shadow-accent-sm);

      @media (hover: hover) {
        &:hover {
          background: var(--color-accent-light);
          border-color: var(--color-accent-light);
          color: white;
          box-shadow: var(--shadow-accent-md);
        }
      }
    }

    &.btn-secondary {
      background: var(--glass-bg);
      backdrop-filter: blur(var(--blur-sm));
      -webkit-backdrop-filter: blur(var(--blur-sm));
      border-color: var(--glass-border);
      color: var(--color-text);

      @media (hover: hover) {
        &:hover {
          background: color-mix(in srgb, white 15%, transparent);
          border-color: color-mix(in srgb, white 25%, transparent);
          color: var(--color-text);
        }
      }
    }

    &.btn-outline-primary {
      background-color: transparent;
      border-color: color-mix(in srgb, white 30%, transparent);
      color: var(--color-text);

      @media (hover: hover) {
        &:hover {
          background-color: color-mix(in srgb, white 10%, transparent);
          border-color: color-mix(in srgb, white 50%, transparent);
          color: var(--color-text);
        }
      }
    }

    &.btn-outline-secondary {
      background-color: transparent;
      border-color: var(--color-primary);
      color: var(--color-primary);

      @media (hover: hover) {
        &:hover {
          background-color: var(--color-primary);
          border-color: var(--color-primary);
          color: var(--color-text-inverse);
        }
      }
    }

    &.btn-ghost-primary {
      background-color: transparent;
      border-color: transparent;
      color: var(--color-accent);

      @media (hover: hover) {
        &:hover {
          background-color: var(--color-accent-light);
          color: var(--color-text);
        }
      }
    }

    &.btn-ghost-secondary {
      background-color: transparent;
      border-color: transparent;
      color: var(--color-primary);

      @media (hover: hover) {
        &:hover {
          background-color: var(--color-bg-soft);
          color: var(--color-primary-dark);
        }
      }
    }

    /* Size variants - override component variables */
    &.btn-sm {
      --btn-padding-block: var(--space-sm-compact);
      --btn-padding-inline: var(--space-md);
      --btn-font-size: var(--font-size-small);
    }

    &.btn-lg {
      --btn-padding-block: var(--space-md);
      --btn-padding-inline: var(--space-xl-compact);
      --btn-font-size: var(--font-size-h6);
    }

    &.btn-block {
      inline-size: 100%;
    }
  }

  /* Outline buttons on dark backgrounds */
  .hero .btn-outline-secondary,
  .tour-cta .btn-outline-secondary,
  .about-cta .btn-outline-secondary,
  .cta-final .btn-outline-secondary {
    border-color: color-mix(in srgb, white 50%, transparent);
    color: var(--color-text);

    @media (hover: hover) {
      &:hover {
        background-color: color-mix(in srgb, white 15%, transparent);
        border-color: color-mix(in srgb, white 80%, transparent);
        color: white;
      }
    }
  }

  /* --------------------------------
     Performance - Cards with Containment
     -------------------------------- */
  .tour-card,
  .testimonial-card,
  .step-card,
  .reason-card,
  .faq-item,
  .value-card,
  .stat-card,
  .post-card,
  .contact-info-card {
    /* CSS Containment for better rendering */
    contain: layout style paint;

    /* Lazy render offscreen content */
    content-visibility: auto;

    /* Reserve space while offscreen */
    contain-intrinsic-size: auto var(--intrinsic-card);
  }

  /* Specific intrinsic sizes for better estimation */
  .step-card {
    contain-intrinsic-size: auto var(--intrinsic-step);
  }

  .testimonial-card {
    contain-intrinsic-size: auto var(--intrinsic-testimonial);
  }

  .tour-card {
    contain-intrinsic-size: auto var(--intrinsic-tour);
  }

  .faq-item {
    contain-intrinsic-size: auto var(--intrinsic-faq);
  }

  .post-card {
    contain-intrinsic-size: auto var(--intrinsic-card);
  }
}

/* ================================
   LAYER: UTILITIES
   ================================ */
@layer utilities {

  /* --------------------------------
     Accessibility
     -------------------------------- */

  /* Focus visible (already 3px ✅) */
  *:focus {
    outline: none;
  }

  *:focus-visible {
    outline: var(--focus-outline-width) solid var(--color-accent);
    outline-offset: var(--focus-outline-offset);
    border-radius: var(--radius-sm);
  }

  a:focus-visible,
  button:focus-visible {
    outline: var(--focus-outline-width) solid var(--color-accent);
    outline-offset: var(--focus-outline-offset);
  }

  /* Reduced transparency for accessibility */
  @media (prefers-reduced-transparency: reduce) {
    .glass,
    .glass-light {
      backdrop-filter: none;
      -webkit-backdrop-filter: none;
      background: var(--color-bg-card);
    }
  }

  /* High contrast mode */
  @media (prefers-contrast: more) {
    .btn-outline-primary,
    .btn-outline-secondary {
      border-width: var(--border-width-strong);
    }

    .section-title-decorated {
      --decorator-height: 2px;
    }
  }
}

/* ================================
   LAYER: OVERRIDES
   (For rare exceptions only)
   ================================ */
@layer overrides {
  /* Intentionally left empty - use sparingly */
}
