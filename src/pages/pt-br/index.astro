---
// @ts-nocheck
/* ================================
   BE FREE TOURS - Home (Português)
   Página inicial em Português
   ================================ */

import BaseLayout from "../../layouts/BaseLayout.astro";
import Hero from "../../components/Hero.astro";
import FeaturedTours from "../../components/FeaturedTours.astro";
import WhyUs from "../../components/WhyUs.astro";
import Testimonials from "../../components/Testimonials.astro";
import FAQ from "../../components/FAQ.astro";
import CTAFinal from "../../components/CTAFinal.astro";
import { homeContent } from "../../data/homeContent.js";
import { testimonials } from "../../data/testimonials.js";
import { getWebSiteSchema } from "../../utils/seoHelpers.js";

// Pega o conteúdo em português
const content = homeContent["pt-br"];

// SEO
const siteUrl = Astro.site?.toString() || "https://befreetours.com.br";
const websiteSchema = getWebSiteSchema(siteUrl);
const monthMap = {
  Jan: "01",
  Feb: "02",
  Mar: "03",
  Apr: "04",
  May: "05",
  Jun: "06",
  Jul: "07",
  Aug: "08",
  Sep: "09",
  Oct: "10",
  Nov: "11",
  Dec: "12"
};

const toIsoDate = (value) => {
  if (!value) return undefined;
  const [month, year] = value.split(" ");
  const mm = monthMap[month];
  if (!mm || !year) return undefined;
  return `${year}-${mm}-01`;
};

// Organization Schema
const organizationSchema = {
  "@type": "TravelAgency",
  "@id": `${siteUrl}/#organization`,
  "name": "Be Free Tours",
  "url": siteUrl,
  "logo": { "@type": "ImageObject", "url": `${siteUrl}/images/logo/logo.png`, "width": 600, "height": 60 },
  "description": "Operadora premium de passeios privados no Rio de Janeiro desde 2013. Experiências personalizadas com guias locais certificados.",
  "telephone": "+55-21-97927-1637",
  "email": "contact@befreetours.com.br",
  "address": { "@type": "PostalAddress", "addressLocality": "Rio de Janeiro", "addressRegion": "RJ", "addressCountry": "BR" },
  "geo": { "@type": "GeoCoordinates", "latitude": "-22.9068", "longitude": "-43.1729" },
  "priceRange": "$$$",
  "aggregateRating": { "@type": "AggregateRating", "ratingValue": "5.0", "reviewCount": "127" }
};

const reviewSchemas = testimonials.map((review) => {
  const published = toIsoDate(review.date);
  const schema = {
    "@type": "Review",
    "author": {
      "@type": "Person",
      "name": review.name
    },
    "reviewRating": {
      "@type": "Rating",
      "ratingValue": String(review.rating),
      "bestRating": "5",
      "worstRating": "1"
    },
    "reviewBody": review.text,
    "name": review.title,
    "itemReviewed": {
      "@type": "Organization",
      "name": "Be Free Tours",
      "url": siteUrl
    }
  };

  if (published) {
    schema.datePublished = published;
  }

  if (review.source) {
    schema.publisher = {
      "@type": "Organization",
      "name": review.source
    };

    if (review.sourceUrl) {
      schema.publisher.url = review.sourceUrl;
    }
  }

  return schema;
});
---

<BaseLayout
  title="Passeios Privados no Rio de Janeiro | Be Free Tours"
  description="Passeios privados premium no Rio desde 2013. Guias locais especialistas, acesso sem filas ao Cristo Redentor e Pão de Açúcar. Experiências personalizadas, itinerários flexíveis. Reserve já!"
  image="/images/og-home.jpg"
  schema={[websiteSchema, organizationSchema, ...reviewSchemas]}
>
  <Hero
    title={content.hero.title}
    subtitle={content.hero.subtitle}
    ctaPrimary={content.hero.ctaPrimary}
    ctaSecondary={content.hero.ctaSecondary}
    lang="pt-br"
  />
  <FeaturedTours lang="pt-br" />
  <WhyUs lang="pt-br" />
  <Testimonials lang="pt-br" />
  <FAQ lang="pt-br" />
  <CTAFinal lang="pt-br" />
</BaseLayout>
